<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{{ page.title }} | {{ site.title }}</title>
<meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
<meta name="author" content="{{ site.author }}">

<!-- Canonical URL -->
<link rel="canonical" href="{{ page.url | replace:'index.html','' | absolute_url }}">

<!-- Open Graph Meta Tags -->
<meta property="og:title" content="{{ page.title }} | {{ site.title }}">
<meta property="og:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
<meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
<meta property="og:url" content="{{ page.url | replace:'index.html','' | absolute_url }}">
<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:locale" content="{{ site.locale }}">
<meta property="og:image" content="{{ '/assets/img/logo.svg' | absolute_url }}">

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@SoludDev">
<meta name="twitter:title" content="{{ page.title }} | {{ site.title }}">
<meta name="twitter:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
<meta name="twitter:image" content="{{ '/assets/img/logo.svg' | absolute_url }}">

<!-- JSON-LD Structured Data for Local Business -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "name": "{{ site.business.name }}",
  "description": "{{ site.description }}",
  "url": "{{ site.url }}",
  "email": "{{ site.email }}",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "{{ site.business.city }}",
    "addressRegion": "{{ site.business.region }}",
    "addressCountry": "{{ site.business.country }}"
  },
  "sameAs": [
    "{{ site.social.bluesky }}",
    "{{ site.social.twitter }}",
    "https://www.linkedin.com/company/soluddev/"
  ]
}
</script>

<!-- Jekyll-safe asset variables -->
<style>
  :root {
    --forest-silhouette: url("{{ '/assets/img/forest-silhouette.svg' | relative_url }}");
  }
</style>

<!-- Preload critical assets -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
<link rel="icon" type="image/svg+xml" href="{{ '/assets/img/favicon.svg' | relative_url }}">
</head>

<body>

<!-- Skip to content link for screen readers -->
<a href="#main-content" class="skip-to-content">Aller au contenu principal</a>

<!-- Cursor glow effect (optional, decorative) -->
<div class="cursor-glow" aria-hidden="true"></div>

<nav class="navbar" role="navigation" aria-label="Navigation principale">
  <div class="container navbar-container">
    <a href="{{ '/' | relative_url }}" class="brand">
      <img src="{{ '/assets/img/logo.svg' | relative_url }}" alt="Logo Solud" class="logo">
      <span>Solud</span>
    </a>
    <button class="hamburger" id="mobile-menu-toggle" aria-label="Basculer le menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <div class="nav-right" id="nav-menu">
      <a href="{{ '/' | relative_url }}" {% if page.url == '/' %}class="active" aria-current="page"{% endif %}>Accueil</a>
      <a href="{{ '/services' | relative_url }}" {% if page.url contains 'services' %}class="active" aria-current="page"{% endif %}>Services</a>
      <a href="{{ '/actualites' | relative_url }}" {% if page.url contains 'actualites' %}class="active" aria-current="page"{% endif %}>ActualitÃ©s</a>
      <button id="theme-toggle" aria-label="Basculer entre thÃ¨me clair et thÃ¨me sombre" aria-pressed="false">
        <span class="theme-icon" aria-hidden="true">ðŸŒ“</span>
      </button>
    </div>
  </div>
</nav>

<header class="hero" role="banner">
  <div class="hero-overlay" aria-hidden="true"></div>
  <div class="container hero-container">
    <h1><span>Solutions TI Ã  La Tuque</span></h1>
    <p>La technologie ancrÃ©e dans la forÃªt â€” un soutien local, moderne et fiable.</p>
    <a href="mailto:{{ site.email }}" class="btn btn-primary btn-magnetic">
      <span>Ã‰crivez-nous</span>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </a>

    <div class="social-banner" role="navigation" aria-label="RÃ©seaux sociaux">
      <a href="{{ site.social.bluesky }}" target="_blank" rel="noopener noreferrer" aria-label="Suivez-nous sur BlueSky">
        <img src="{{ '/assets/img/bsky.svg' | relative_url }}" alt="BlueSky">
      </a>
      <a href="{{ site.social.twitter }}" target="_blank" rel="noopener noreferrer" aria-label="Suivez-nous sur X (Twitter)">
        <img src="{{ '/assets/img/x.svg' | relative_url }}" alt="X (Twitter)">
      </a>
      <a href="https://www.linkedin.com/company/soluddev/" target="_blank" rel="noopener noreferrer" aria-label="Suivez-nous sur LinkedIn">
        <img src="{{ '/assets/img/linkedin.svg' | relative_url }}" alt="LinkedIn">
      </a>
    </div>
  </div>
</header>

<main id="main-content">
  {{ content }}
</main>

<footer role="contentinfo">
  <div class="container footer-container">
    <div class="footer-left">
      <p>&copy; {{ site.title }} â€” <a href="mailto:{{ site.email }}">{{ site.email }}</a></p>
      <p class="footer-links">
        <a href="{{ '/confidentialite' | relative_url }}">ConfidentialitÃ©</a>
      </p>
    </div>
    <div class="socials" role="navigation" aria-label="Liens vers rÃ©seaux sociaux">
      <a href="{{ site.social.bluesky }}" target="_blank" rel="noopener noreferrer" aria-label="Suivez-nous sur BlueSky">
        <img src="{{ '/assets/img/bsky.svg' | relative_url }}" alt="BlueSky">
      </a>
      <a href="{{ site.social.twitter }}" target="_blank" rel="noopener noreferrer" aria-label="Suivez-nous sur X (Twitter)">
        <img src="{{ '/assets/img/x.svg' | relative_url }}" alt="X (Twitter)">
      </a>
      <a href="https://www.linkedin.com/company/soluddev/" target="_blank" rel="noopener noreferrer" aria-label="Suivez-nous sur LinkedIn">
        <img src="{{ '/assets/img/linkedin.svg' | relative_url }}" alt="LinkedIn">
      </a>
    </div>
  </div>
</footer>

<!-- Scroll to top button -->
<button id="scroll-to-top" aria-label="Retour en haut de la page">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
    <path d="M12 19V5M5 12l7-7 7 7"/>
  </svg>
</button>

<script>
(function() {
  'use strict';

  // ==================
  // Utility Functions
  // ==================
  function debounce(func, wait) {
    let timeout;
    return function executedFunction() {
      const context = this;
      const args = arguments;
      clearTimeout(timeout);
      timeout = setTimeout(function() {
        func.apply(context, args);
      }, wait);
    };
  }

  function throttle(func, limit) {
    let inThrottle;
    return function() {
      const context = this;
      const args = arguments;
      if (!inThrottle) {
        func.apply(context, args);
        inThrottle = true;
        setTimeout(function() {
          inThrottle = false;
        }, limit);
      }
    };
  }

  // ==================
  // Theme Toggle
  // ==================
  const themeToggle = document.getElementById('theme-toggle');
  const html = document.documentElement;

  function getInitialTheme() {
    try {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark' || savedTheme === 'light') {
        return savedTheme;
      }
    } catch (e) {
      console.warn('localStorage not available:', e.message);
    }
    
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    
    return 'light';
  }

  function applyTheme(theme) {
    const isDark = theme === 'dark';
    if (isDark) {
      html.classList.add('dark');
    } else {
      html.classList.remove('dark');
    }
    if (themeToggle) {
      themeToggle.setAttribute('aria-pressed', String(isDark));
    }
  }

  // Apply initial theme
  const initialTheme = getInitialTheme();
  applyTheme(initialTheme);

  // Theme toggle handler
  if (themeToggle) {
    themeToggle.addEventListener('click', function() {
      const isDark = html.classList.contains('dark');
      const newTheme = isDark ? 'light' : 'dark';
      applyTheme(newTheme);
      
      try {
        localStorage.setItem('theme', newTheme);
      } catch (e) {
        console.warn('Unable to save theme preference:', e.message);
      }
    });
  }

  // ==================
  // Mobile Menu Toggle
  // ==================
  const hamburger = document.getElementById('mobile-menu-toggle');
  const navMenu = document.getElementById('nav-menu');
  const body = document.body;

  function closeMenu() {
    if (hamburger && navMenu) {
      hamburger.classList.remove('active');
      navMenu.classList.remove('active');
      body.classList.remove('menu-open');
      hamburger.setAttribute('aria-expanded', 'false');
    }
  }

  function toggleMenu() {
    if (hamburger && navMenu) {
      const isActive = hamburger.classList.toggle('active');
      navMenu.classList.toggle('active');
      body.classList.toggle('menu-open');
      hamburger.setAttribute('aria-expanded', String(isActive));
    }
  }

  if (hamburger && navMenu) {
    hamburger.addEventListener('click', toggleMenu);

    // Close menu when clicking a link
    navMenu.querySelectorAll('a').forEach(function(link) {
      link.addEventListener('click', closeMenu);
    });

    // Close menu when clicking outside
    document.addEventListener('click', function(e) {
      if (!navMenu.contains(e.target) && 
          !hamburger.contains(e.target) && 
          navMenu.classList.contains('active')) {
        closeMenu();
      }
    });

    // Close menu on escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && navMenu.classList.contains('active')) {
        closeMenu();
        hamburger.focus();
      }
    });
  }

  // ==================
  // Scroll to Top Button
  // ==================
  const scrollBtn = document.getElementById('scroll-to-top');

  if (scrollBtn) {
    const handleScroll = throttle(function() {
      if (window.pageYOffset > 300) {
        scrollBtn.classList.add('visible');
      } else {
        scrollBtn.classList.remove('visible');
      }
    }, 100);

    window.addEventListener('scroll', handleScroll, { passive: true });

    scrollBtn.addEventListener('click', function() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
  }

  // ==================
  // Intersection Observer for Animations
  // ==================
  if ('IntersectionObserver' in window) {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    // Observe elements with animation classes
    const animatedElements = document.querySelectorAll('.fade-in, .slide-up, .scale-in, .card');
    animatedElements.forEach(function(el) {
      observer.observe(el);
    });
  } else {
    // Fallback for browsers without IntersectionObserver
    const animatedElements = document.querySelectorAll('.fade-in, .slide-up, .scale-in, .card');
    animatedElements.forEach(function(el) {
      el.classList.add('visible');
    });
  }

  // ==================
  // Magnetic Button Effect
  // ==================
  const magneticButtons = document.querySelectorAll('.btn-magnetic');

  if (magneticButtons.length > 0 && !window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    magneticButtons.forEach(function(btn) {
      btn.addEventListener('mousemove', function(e) {
        const rect = btn.getBoundingClientRect();
        const x = e.clientX - rect.left - rect.width / 2;
        const y = e.clientY - rect.top - rect.height / 2;
        
        btn.style.transform = 'translate(' + (x * 0.2) + 'px, ' + (y * 0.2) + 'px)';
      });
      
      btn.addEventListener('mouseleave', function() {
        btn.style.transform = 'translate(0, 0)';
      });
    });
  }

  // ==================
  // Performance: Reduce Motion for Users Who Prefer It
  // ==================
  if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    const style = document.createElement('style');
    style.textContent = `
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    `;
    document.head.appendChild(style);
  }

  // ==================
  // Error Handling for Images
  // ==================
  document.querySelectorAll('img').forEach(function(img) {
    img.addEventListener('error', function() {
      console.warn('Failed to load image:', img.src);
      // You could set a fallback image here if desired
      // img.src = '/assets/img/placeholder.svg';
    });
  });

})();
</script>

</body>
</html>
